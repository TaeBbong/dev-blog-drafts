# Ch 1. Dart & Flutter 컴파일의 시작(JIT와 AOT)

우리는 Dart라는 언어로 Flutter 프레임워크를 활용해 앱 코드를 작성하고, 디버깅하거나 빌드하여 각 환경에 맞게 실행합니다. 막연히 Flutter는 크로스 플랫폼을 지원하는 프레임워크라 알고 있을텐데, 어떻게 Dart 코드가 각 네이티브 환경에서 실행되는지 제대로 알지 못하고 있습니다.
이번 글에서는 Dart 코드가 어떻게 여러 플랫폼에서 실행되는지 전반적인 이해를 다루고, Dart VM의 핵심 개념인 JIT과 AOT에 대해 알아보겠습니다.

## Dart VM이란?

Dart 언어는 다른 언어들과 비슷하게 컴파일 과정을 거쳐 우리의 코드를 기계가 이해할 수준의 언어로 변환합니다. 그렇다고 단순히 컴파일 과정만을 거쳐서 우리가 원하는 앱이 되진 않습니다. 크게 보면 Dart 언어로 작성된 코드를 컴파일하는 단계, 그리고 컴파일된 기계어를 바탕으로 각 플랫폼 별 엔진을 거쳐 빌드되는 단계로 나눌 수 있습니다.

Dart VM은 Dart 코드를 각 플랫폼에서 네이티브로 실행하는 하나의 큰 시스템입니다. 여기엔 다양한 런타임 시스템, 객체 모델, 가비지 컬렉션, 스냅샷, 컴파일 파이프라인 등 여러 요소들이 있습니다.

Dart VM은 여러 방식으로 코드 실행을 지원합니다.

> 참고 문헌
> https://mrale.ph/dartvm/ > https://medium.com/@howyoujini/%EC%BD%94%EB%93%9C%EA%B0%80-%EC%96%B4%EB%96%BB%EA%B2%8C-%ED%99%94%EB%A9%B4%EC%9D%B4-%EB%90%98%EB%82%98-1-aot-vs-jit-compilation-with-flutter-19af2b5f8d51

====

dart는 컴파일 언어
이렇게 컴파일된 Dart 코드를 Flutter 엔진에 전달, 엔진에서 이를 렌더링하여 앱으로 보여줌
이 중에서 컴파일 절차에 대해 먼저 알아보자.

컴파일 방식은 두개(AOT, JIT)
AOT는 릴리즈 모드에서 동작하는 컴파일 방식
JIT는 디버깅 모드에서 동작하는 컴파일 방식
이 둘의 차이는 컴파일러와 인터프리터 정도의 차이를 만들어냄

AOT에서는 gen_snapshot이라는 다트 컴파일러가 Kernel AST를 네이티브 ARM 머신 코드로 직접 컴파일함
이 과정에서 트리 쉐이킹 등의 최적화 프로세스도 동작

JIT는 frontend_server라는 프로세스를 통해 다트 컴파일러가 다트 코드를 Kernel AST로 변환
이는 기기에 전송되어 스크립트 스냅샷 형태로 변환되고, 런타임에 실행 가능한 머신 코드로 컴파일 됨
이 덕분에 Hot Reload 가능
